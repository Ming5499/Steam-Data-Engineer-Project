{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.9", "generated_at": "2025-08-21T06:50:44.167163Z", "invocation_id": "a411cbdf-a6ad-45f9-91a5-a65dd0c7dfc5", "env": {}}, "results": [{"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:29.492052Z", "completed_at": "2025-08-21T06:50:29.670327Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:29.711238Z", "completed_at": "2025-08-21T06:50:29.713044Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.4065554141998291, "adapter_response": {}, "message": "Runtime Error in model mongo_connect (models/utilities/mongo_connect.py)\n  Materialization \"materialization_table_default\" only supports languages ['sql']; got \"python\"", "failures": null, "unique_id": "model.steam_analytics.mongo_connect", "compiled": true, "compiled_code": "import pandas as pd\r\n\r\ndef model(dbt, session):\r\n    dbt.config(\r\n        materialized=\"table\",\r\n        packages=[\"pymongo\"]\r\n    )\r\n    \r\n    # Your MongoDB connection code here\r\n    from pymongo import MongoClient\r\n    client = MongoClient(\"mongodb://mongodb:27017/\")\r\n    \r\n    # Return data as a DataFrame\r\n    db = client[dbt.config.get_var('mongo_database')]\r\n    data = list(db[dbt.config.get_var('mongo_collection')].find())\r\n    \r\n    return pd.DataFrame(data)\n\n\n# This part is user provided model code\n# you will need to copy the next section to run the code\n# COMMAND ----------\n# this part is dbt logic for get ref work, do not modify\n\ndef ref(*args, **kwargs):\n    refs = {}\n    key = '.'.join(args)\n    version = kwargs.get(\"v\") or kwargs.get(\"version\")\n    if version:\n        key += f\".v{version}\"\n    dbt_load_df_function = kwargs.get(\"dbt_load_df_function\")\n    return dbt_load_df_function(refs[key])\n\n\ndef source(*args, dbt_load_df_function):\n    sources = {}\n    key = '.'.join(args)\n    return dbt_load_df_function(sources[key])\n\n\nconfig_dict = {}\n\n\nclass config:\n    def __init__(self, *args, **kwargs):\n        pass\n\n    @staticmethod\n    def get(key, default=None):\n        return config_dict.get(key, default)\n\nclass this:\n    \"\"\"dbt.this() or dbt.this.identifier\"\"\"\n    database = \"None\"\n    schema = \"steam_db\"\n    identifier = \"mongo_connect\"\n    \n    def __repr__(self):\n        return '`steam_db`.`mongo_connect`'\n\n\nclass dbtObj:\n    def __init__(self, load_df_function) -> None:\n        self.source = lambda *args: source(*args, dbt_load_df_function=load_df_function)\n        self.ref = lambda *args, **kwargs: ref(*args, **kwargs, dbt_load_df_function=load_df_function)\n        self.config = config\n        self.this = this()\n        self.is_incremental = False\n\n# COMMAND ----------\n\n\n", "relation_name": "`steam_db`.`mongo_connect`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:29.611233Z", "completed_at": "2025-08-21T06:50:29.694656Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:29.828116Z", "completed_at": "2025-08-21T06:50:30.872462Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 1.4666500091552734, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.stg_crawl_state", "compiled": true, "compiled_code": "\n\nSELECT\n    game_appid,\n    last_review_timestamp,\n    last_price_timestamp\nFROM `steam_db`.`crawl_state`", "relation_name": "`steam_db_staging`.`stg_crawl_state`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:29.646747Z", "completed_at": "2025-08-21T06:50:29.710086Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:29.776324Z", "completed_at": "2025-08-21T06:50:30.956615Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.4347832202911377, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.stg_developers", "compiled": true, "compiled_code": "\n\nSELECT\n    dev_id,\n    name\nFROM `steam_db`.`developers`\nWHERE name IS NOT NULL AND name != ''", "relation_name": "`steam_db_staging`.`stg_developers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:29.593319Z", "completed_at": "2025-08-21T06:50:29.676189Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:29.723271Z", "completed_at": "2025-08-21T06:50:31.027865Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.5906226634979248, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.example_model", "compiled": true, "compiled_code": "SELECT 1 AS test_column", "relation_name": "`steam_db`.`example_model`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:29.910770Z", "completed_at": "2025-08-21T06:50:29.944454Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:29.951380Z", "completed_at": "2025-08-21T06:50:31.056306Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.173083782196045, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.stg_games", "compiled": true, "compiled_code": "\n\nSELECT\n    game_id,\n    title,\n    description,\n    release_date,\n    windows_req,\n    mac_req,\n    linux_req,\n    required_age,\n    awards\nFROM `steam_db`.`games`\nWHERE title IS NOT NULL AND title != ''", "relation_name": "`steam_db_staging`.`stg_games`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:30.912412Z", "completed_at": "2025-08-21T06:50:30.941885Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:30.945960Z", "completed_at": "2025-08-21T06:50:31.732446Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.8326461315155029, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.stg_genres", "compiled": true, "compiled_code": "\n\nSELECT\n    genre_id,\n    name\nFROM `steam_db`.`genres`\nWHERE name IS NOT NULL AND name != ''", "relation_name": "`steam_db_staging`.`stg_genres`"}, {"status": "error", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:31.802472Z", "completed_at": "2025-08-21T06:50:31.835757Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 0.23971128463745117, "adapter_response": {}, "message": "Compilation Error in model stg_reviews (models/staging/stg_reviews.sql)\n  'get_reviews' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with \"dbt deps\".", "failures": null, "unique_id": "model.steam_analytics.stg_reviews", "compiled": false, "compiled_code": null, "relation_name": "`steam_db_staging`.`stg_reviews`"}, {"status": "skipped", "timing": [], "thread_id": "Thread-3 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.steam_analytics.fact_reviews", "compiled": false, "compiled_code": null, "relation_name": "`steam_db_analytics`.`fact_reviews`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:31.033852Z", "completed_at": "2025-08-21T06:50:31.084210Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:31.110078Z", "completed_at": "2025-08-21T06:50:32.159326Z"}], "thread_id": "Thread-4 (worker)", "execution_time": 1.1445622444152832, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.stg_languages", "compiled": true, "compiled_code": "\n\nSELECT\n    lang_id,\n    name\nFROM `steam_db`.`languages`\nWHERE name IS NOT NULL AND name != ''", "relation_name": "`steam_db_staging`.`stg_languages`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:31.142723Z", "completed_at": "2025-08-21T06:50:31.244451Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:31.261677Z", "completed_at": "2025-08-21T06:50:32.184213Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0604074001312256, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.stg_prices", "compiled": true, "compiled_code": "\n\nSELECT\n    price_id,\n    game_id,\n    price,\n    discount,\n    initial_price,\n    timestamp\nFROM `steam_db`.`prices`\nWHERE price >= 0 AND discount >= 0 AND initial_price >= 0", "relation_name": "`steam_db_staging`.`stg_prices`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:31.233571Z", "completed_at": "2025-08-21T06:50:31.259236Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:31.283654Z", "completed_at": "2025-08-21T06:50:32.200870Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 1.0628461837768555, "adapter_response": {"_message": "SUCCESS 0", "code": "SUCCESS", "rows_affected": 0}, "message": "SUCCESS 0", "failures": null, "unique_id": "model.steam_analytics.stg_publishers", "compiled": true, "compiled_code": "\n\nSELECT\n    pub_id,\n    name\nFROM `steam_db`.`publishers`\nWHERE name IS NOT NULL AND name != ''", "relation_name": "`steam_db_staging`.`stg_publishers`"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-08-21T06:50:32.309522Z", "completed_at": "2025-08-21T06:50:32.365333Z"}, {"name": "execute", "started_at": "2025-08-21T06:50:32.368156Z", "completed_at": "2025-08-21T06:50:44.008396Z"}], "thread_id": "Thread-3 (worker)", "execution_time": 11.715879678726196, "adapter_response": {"_message": "SUCCESS 26165", "code": "SUCCESS", "rows_affected": 26165}, "message": "SUCCESS 26165", "failures": null, "unique_id": "model.steam_analytics.dim_games", "compiled": true, "compiled_code": "\n\nSELECT\n    g.game_id,\n    g.title,\n    g.description,\n    g.release_date,\n    g.required_age,\n    GROUP_CONCAT(DISTINCT d.name) AS developers,\n    GROUP_CONCAT(DISTINCT p.name) AS publishers,\n    GROUP_CONCAT(DISTINCT gn.name) AS genres,\n    GROUP_CONCAT(DISTINCT l.name) AS languages\nFROM `steam_db_staging`.`stg_games` g\nLEFT JOIN `steam_db`.`game_developers` gd ON g.game_id = gd.game_id\nLEFT JOIN `steam_db_staging`.`stg_developers` d ON gd.dev_id = d.dev_id\nLEFT JOIN `steam_db`.`game_publishers` gp ON g.game_id = gp.game_id\nLEFT JOIN `steam_db_staging`.`stg_publishers` p ON gp.pub_id = p.pub_id\nLEFT JOIN `steam_db`.`game_genres` gg ON g.game_id = gg.game_id\nLEFT JOIN `steam_db_staging`.`stg_genres` gn ON gg.genre_id = gn.genre_id\nLEFT JOIN `steam_db`.`game_languages` gl ON g.game_id = gl.game_id\nLEFT JOIN `steam_db_staging`.`stg_languages` l ON gl.lang_id = l.lang_id\nGROUP BY g.game_id, g.title, g.description, g.release_date, g.required_age", "relation_name": "`steam_db_analytics`.`dim_games`"}, {"status": "skipped", "timing": [], "thread_id": "Thread-1 (worker)", "execution_time": 0, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.steam_analytics.game_quality_metrics", "compiled": false, "compiled_code": null, "relation_name": "`steam_db_analytics`.`game_quality_metrics`"}], "elapsed_time": 15.373377084732056, "args": {"cache_selected_only": false, "exclude": [], "log_format_file": "debug", "favor_state": false, "use_colors": true, "printer_width": 80, "show_resource_report": false, "project_dir": "/usr/app/dbt/steam_analytics", "which": "run", "partial_parse_file_diff": true, "vars": {}, "quiet": false, "use_colors_file": true, "log_path": "/usr/app/dbt/steam_analytics/logs", "log_file_max_bytes": 10485760, "strict_mode": false, "log_level_file": "debug", "select": [], "warn_error_options": {"include": [], "exclude": []}, "indirect_selection": "eager", "partial_parse": true, "static_parser": true, "version_check": true, "invocation_command": "dbt run", "defer": false, "log_level": "info", "enable_legacy_logger": false, "populate_cache": true, "print": true, "introspect": true, "macro_debugging": false, "write_json": true, "log_format": "default", "send_anonymous_usage_stats": true, "profiles_dir": "/usr/app/dbt/steam_analytics"}}